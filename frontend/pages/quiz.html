<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Quiz</title>
  <link rel="stylesheet" href="../assets/app.css" />
</head>
<body>
  <div id="nav"></div>

  <div class="container">
    <div id="err" class="err" style="display:none"></div>

    <div id="box" class="card">
      Loading...
    </div>
  </div>

  <script src="../assets/app.js"></script>
  <script>
    mountNav();

    function showErr(msg) {
      const e = document.getElementById("err");
      if (!msg) { e.style.display = "none"; e.textContent = ""; return; }
      e.style.display = "block";
      e.textContent = msg;
    }

    function getId() {
      const url = new URL(window.location.href);
      return url.searchParams.get("id");
    }

    async function load() {
      showErr("");
      const id = getId();
      if (!id) {
        document.getElementById("box").innerHTML = "";
        showErr("Missing quiz id in URL");
        return;
      }

      try {
        const q = await request(`/quizzes/${id}`, "GET");
        document.getElementById("box").innerHTML = `
          <div class="row" style="justify-content:space-between;align-items:flex-start">
            <div>
              <h2 style="margin:0 0 6px">${q.title || "Untitled"}</h2>
              <div class="muted">${q.description || ""}</div>
              <div class="hr"></div>
              <div class="row">
                <span class="badge">${q.category || "General"}</span>
                <span class="badge">Questions: ${(q.questions || []).length}</span>
              </div>
            </div>
            <div style="text-align:right">
              <div class="muted" style="font-weight:800">Quiz</div>
              <div class="pill muted" style="font-weight:700">${String(q._id).slice(-10)}</div>
            </div>
          </div>

          <div class="hr"></div>

          <div class="row" style="justify-content:space-between">
            <a href="./quizzes.html">‚Üê Back to list</a>
            <a href="./take.html?id=${q._id}">
              <button>Start Quiz</button>
            </a>
          </div>
        `;
      } catch (e) {
        document.getElementById("box").innerHTML = "";
        showErr(e.message);
      }
    }

    load();
  </script>
</body>
</html>
