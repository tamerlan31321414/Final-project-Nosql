<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>My Attempts</title>
  <link rel="stylesheet" href="../assets/app.css" />
</head>
<body>
  <div id="nav"></div>
  <div class="container">
    <h2>My Attempts</h2>
    <div id="err" class="err"></div>
    <div id="list"></div>
  </div>

  <script src="../assets/app.js"></script>
  <script>
    mountNav();
    requireAuth();

    async function load() {
      document.getElementById("err").textContent = "";
      try {
        const items = await request("/me/attempts", "GET");
        const el = document.getElementById("list");
        el.innerHTML = "";
        items.forEach((a) => {
          const div = document.createElement("div");
          div.className = "card";
          const dt = a.submittedAt ? new Date(a.submittedAt).toLocaleString() : "";
          div.innerHTML = `
            <div style="font-weight:700">${a.quizId?.title || "Quiz"}</div>
            <div>Score: ${a.score} / ${a.maxScore}</div>
            <div>Duration: ${a.durationSec}s</div>
            <div style="opacity:.8">${dt}</div>
          `;
          el.appendChild(div);
        });
      } catch (e) {
        document.getElementById("err").textContent = e.message;
      }
    }

    load();
  </script>
</body>
</html>
